2023-09-29	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 2.0
	  Significant portability updates: IMYplay now compiles also on macOS
	  (as provided by Travis CI) and MinGW. IMYplay now compiles by default
	  also on Solaris/SunOS (earlier, the PC-Speaker module had to be
	  disabled during configuration). Added an installer for the MinGW
	  version with SDLv2 included. Added support for GStreamer versions
	  1.x. Significant improvements in the parsers, especially the
	  flex-based one. Significant improvements in the configuration script.
	  Added more sound drivers in the Allegro backend. Enabled stereo
	  output in newer JACK versions. Many more safety checks in the code.
	  Added replacement functions in case some standard ones are missing.
	  Printing run-time versions apart from the compile-time versions
	  where available. Print the error code if backend initialization or
	  playing a note fails. Improvements in the build system. The DOS
	  version can now be built with the flex-based parser. Code quality
	  updates. Added unit tests for all backends. Improvements in the
	  documentation. Version bumped to 2.0 because of the vast changes and
	  to accommodate for the big step in version 0.3.
	* configure.ac: Separated application name and tar-name, added URL.
	  Show LibHideIP and LibNetBlock as disabled by default. If Allegro
	  libraries were not found directly, but using allegro-config, show
	  that, or show that Allegro is disabled otherwise, and redirect the
	  error output from allegro-config to /dev/null. Use dedicated macros
	  to check for off_t, size_t, ssize_t, uint32_t and 'long long'. Check
	  for the <strings.h> header, the strcasecmp() function and use a
	  dedicated macro to check for the strcasecmp() function's include.
	  Use a dedicated macro to check for the fseeko() function. Added a
	  note about why we're not using AC_FUNC_SELECT_ARGTYPES. Fix wrong
	  reason given in the summary when 'flex' is missing. Check for and
	  require the KIOCSOUND constant to enable the PC-Speaker backend.
	  Fixed the summary condition checking if SDLv1 will be compiled in if
	  SDLv2 is missing or unusable. Fix the test for pkg-config existence
	  in the summary section for GStreamer. Added checking for the
	  -fanalyzer compiler option, disable because of the flex output file.
	  Reduced the warning about flex to "notice", because the parser now
	  skips (more) binary data and should work better. Added support for
	  GStreamer version 1.x. Added checking for the strdup() function.
	  Added checking for the getenv() function for MinGW. Disable stack
	  protections when cross-compiling (otherwise, GCC libraries, like
	  "libssp-0.dll" are required at run-time). Added creating
	  setup/Makefile. Other small changes.
	* configure.ac, src/Makefile.am: Set Allegro libraries in another way.
	* src/imyp_cfg.hin: Added a constant for 'long long'. Added constants
	  for the strcasecmp() function and its header file. Added a constant
	  for the KIOCSOUND #define. Updated the package constants. Added
	  constants for the strdup() and getenv() functions.
	* src/imyplay.h: Remove our substitution of off_t - the dedicated
	  macro in configure.ac takes care of that.
	* src/midibase.h: Change the detection of presence of uint32_t.
	* src/imyputil.c: Changed #if to #ifdef for sys/time.h include. Added
	  the missing #include <stdlib.h> for malloc().
	* src/imyputil.{c,h}: Don't declare imyp_compare() if strcasecmp() is
	  available and use a macro for the function. Add imyp_memcopy(),
	  imyp_mem_set() and imyp_duplicate_string() as replacements for the
	  memcpy(), memset() and strdup() functions, if they're not present,
	  and add the relevant IMYP_ macros.
	* src/imyputil.c (imyp_parse_system, imyp_get_format): Use the new
	  macro instead of strcasecmp() / imyp_compare().
	* src/imyputil.c (imyp_pause_select): Added a note about why we're not
	  using AC_FUNC_SELECT_ARGTYPES.
	* src/imyp_all.c: Allow compiling on MinGW.
	* src/imyparse.c (imyp_play_current_note): Remove duplicated NULL
	  parameter check. Print the error code if playing a note fails.
	* src/imyparsf.l (imyp_play_current_note): Fix the check for the
	  current output backend, and the function comment. Print the error
	  code if playing a note fails.
	* src/imyparsf.l (imyp_make_pause): Fix the check for the current
	  output backend.
	* src/imyp_all.c: Added more sound drivers.
	* src/imyplay.{c,h}: Added messages for version numbers.
	* src/imyp_gst.c (imyp_gst_version): Print also the run-time version
	  being used and mark the static version as used during compiling.
	* src/imyp_pul.c (imyp_pulse_version): Print also the run-time version
	  being used and mark the static version as used during compiling.
	* src/imyp_sdl.c (imyp_sdl_version): Print also the run-time version
	  being used (available in SDL >= 2) and mark the static version as
	  the one used during compiling.
	* src/imyp_all.c (imyp_all_play_tune): Use the new IMYP_ replacement
	  function.
	* src/imyp_ao.c (imyp_ao_init): Use the new IMYP_ replacement function.
	* src/imyparse.c (imyp_play_file): Use the new IMYP_ replacement
	  function.
	* src/imyp_fil.c (imyp_file_pause): Use the new IMYP_ replacement
	  function.
	* src/imyp_gst.c (imyp_gst_init): Use the new IMYP_ replacement
	  function.
	* src/imyp_jck.c (imyp_jack_fill_buffer, imyp_jack_play_tune): Use
	  the new IMYP_ replacement function.
	* src/imyp_sdl.c (imyp_sdl_play_tune, imyp_sdl_fill_buffer): Use the
	  new IMYP_ replacement function.
	* src/imyp_sig.c (imyp_set_sigh): Use the new IMYP_ replacement
	  function.
	* src/imyputil.c (imyp_generate_filename): Use the new IMYP_
	  replacement function.
	* src/imyp_exe.c (launch_program, imyp_exec_init): Use the new IMYP_
	  replacement function.
	* src/imypwrap.c (imyp_init_selected): Added a check for NULL. Use a
	  distinct error code when the selected library can't be initialized.
	* src/imyparsf.l: Add "[\r\n]+" to "^BEGIN:IMELODY" to avoid an empty
	  line printed at the beginning of input. Skip (more) binary data.
	  Support the COMPOSER and COPYRIGHT fields. Support CRLF line endings
	  in all parts. Fixed an empty line being output in the place of the
	  melody line. Skip displaying the final "END:IMELODY". Fix the repeat
	  block iteration count. Use VOLUME_MODIFIER in REPEAT_BLOCK instead
	  of repeating the regex.
	* src/imyparse.c (imyp_play_file): Fixed parser hanging on the "("
	  character. Fixed parsing the repeat blocks.
	* src/imyplay.c (print_help, main): Show "IMYplay" as the program name
	  in the help and version messages, but keep "imyplay" in the syntax.
	* src/imyp_gst.c (global scope, imyp_gst_play_tune, imyp_gst_init,
	  imyp_gst_close): Added support for GStreamer version 1.x.
	* src/imyp_jck.c (struct imyp_jack_backend_data, imyp_jack_fill_buffer,
	  imyp_jack_init, imyp_jack_close, imyp_jack_fill_single_buffer - new
	  function): Enable stereo output.
	* src/imyp_als.c (imyp_alsa_play_tune): Fixed crash with duration = 0.
	* src/imyp_ao.c (imyp_ao_play_tune): Fixed crash with duration = 0.
	* src/imyp_jck.c (imyp_jack_play_tune): Fixed crash with buf = NULL.
	* src/imyp_por.c (imyp_portaudio_play_tune): Check if the stream is
	  valid before using.
	* src/imyp_pul.c (imyp_pulse_play_tune): Fixed crash with duration=0.
	* src/imyp_sdl.c (imyp_sdl_play_tune): Fixed crash with buf = NULL.
	* src/imyp_fil.c (imyp_file_init): Fixed crash with a constant "dev"
	  parameter.
	* src/imyp_all.c (imyp_all_init): Fixed crash with a constant
	  "dev_file" parameter.
	* src/imyp_por.c (imyp_portaudio_init): Fixed crash with a constant
	  "dev_file" parameter.
	* src/imyp_sdl.c (imyp_sdl_init): Fixed crash with a constant
	  "dev_file" parameter. Add some default audio driver for SDL using an
	  environment variable SDL_AUDIODRIVER, if none is set.
	* src/imyp_mid.c (imyp_midi_play_tune): Check if the output handle is
	  valid before using.
	* src/imyparsf.l (imyp_play_file): Don't call yylex_destroy() under
	  DOS - not available in flex 2.5.4.
	* src/imyplay.c (main): Show the error code if initialization failed.
	* src/imypwrap.c (imyp_lib_init): Use a distinct error code when no
	  library has been initialized (or found).
	* src/{imyp_exe.*,imyp_fil.*,imyp_mid.*,imyp_oss.*,imyp_spk.*,
	  imyparse.c,imyplay.*,imyputil.*,iparsers.c,imypwrap.*}, README.md,
	  doc/sf_bogdro.css: Quality fixes.
	* test/imcommon.h: Added a header for things common to tests.
	* test/utiltest.c: Skip testing imyp_compare() if strcasecmp() is
	  available. Use imcommon.h.
	* test/testalle.c: Added a test for the Allegro backend.
	* test/testalsa.c: Added a test for the ALSA backend.
	* test/testao.c: Added a test for the AO/LibAO backend.
	* test/testexec.c: Added a test for the EXEC backend.
	* test/testfile.c: Added a test for the FILE backend.
	* test/testgst.c: Added a test for the GStreamer backend.
	* test/testjack.c: Added a test for the JACK backend.
	* test/testmidi.c: Added a test for the MIDI backend.
	* test/testoss.c: Added a test for the OSS backend.
	* test/testport.c: Added a test for the PortAudio backend.
	* test/testpuls.c: Added a test for the Pulseaudio backend.
	* test/testsdl.c: Added a test for the SDL backend.
	* test/testspk.c: Added a test for the PC-Speaker backend.
	* test/Makefile.am: Renamed 'zcompile' to 'x-compile'.
	* m4/ax_include_strcasecmp.m4: A dedicated macro to check for the
	  strcasecmp() function's include.
	* Makefile.dos, dosfiles.txt: Allow building with the flex-based
	  parser by passing FLEX=1 to 'make'.
	* dosdist.bat: Use the hand-written parser by default for simplicity.
	* setup: Added an NSIS-based installer for the MinGW version.
	* Makefile.am: Added the necessary files from the setup directory to
	  the distribution.
	* po/*.{po,gmo,pot}: Updated and corrected translations and their
	  metadata (line numbers and dates).
	* doc/sf_bogdro.css: Added CSS for HTML docs.
	* INSTALL-imyplay.txt, README, doc/imyplay.txc: Updated the supported
	  OS list, fixed indents. Documented the "CC", "CC_OPTS" and the new
	  "FLEX" parameter.
	* README, doc/imyplay.txc: Added a link to the iMelody Wikipedia page.
	  Added the "pcspkr" kernel module as a module like "snd-pcsp" on
	  some systems. Added information related to the MinGW version (SDL
	  driver).
	* doc/imyplay.txc, doc/imyplay.1: Leave just the SourceForge address.
	* README: Added the SourceForge URL.
	* doc/imyplay.txc: Fixed navigation in submenus. Typo fixes and other
	  small updates.
	* imyplay.spi: Added texinfo to BuildRequires. Added the %{?dist} tag
	  to 'Release:', as recommended by the Fedora packaging guidelines:
	  https://docs.fedoraproject.org/en-US/packaging-guidelines/DistTag/.
	* src/*.c, src/*.h, src/*.hin, doc/imyplay.txc, test/*.c, src/*.l,
	  src/*.asm, */Makefile.am, dosdist.bat, Makefile.dos, po/pl.po,
	  configure.ac, README, imyplay.spi: Updated (or added) the license
	  blocks.
	* INSTALL, compile, depcomp, doc/texinfo.tex, missing, test-driver,
	  po/en@boldquot.insert-header, po/en@boldquot.po, po/en@quot.po,
	  po/en@quot.insert-header, po/remove-potcdate.sed, ylwrap: Forced
	  update using new Autotools.

2021-10-21	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 1.3
	  SDLv2 support. Improvements in the SDL backend. Fixed the MIDI
	  backend on 64-bit systems. Fixed the EXEC backend with a missing
	  parameter. Fixed uninitialized values in the JACK backend. Updates
	  in the build system for DOS. Other compatibility improvements.
	  Documentation updates and improvements. Translations rebuilt. New
	  unit tests.
	* configure.ac: Updated using autoconf 2.71. Disable XIPH_PATH_AO()
	  because of incompatibilities and continue checking manually.
	  Double-quote all AC_MSG_* messages. Added enabling all Automake
	  warnings. Added checking for the stdint.h header, now required by
	  the MIDI backend because of compatibility issues on 64-bit systems.
	  Made the descriptions of --enable-XX options similar. Added SDLv2
	  support (since function names are the same for SDLv1 and SDLv2, it's
	  not possible to enable both backends at the same time; also, since
	  header names are also the same, searching for just "SDL.h" is not
	  supported anymore - the script searches for SDL2/SDL.h and then
	  for SDL/SDL.h).
	* src/imyputil.c: updated #including the time header files as
	  recommended by the new autoconf.
	* src/imyp_cfg.hin: added defining HAVE_STDINT_H.
	* src/midibase.h: define DWORD to be a 32-bit type - uint32_t when
	  available, or unsigned long otherwise (the default). This fixes an
	  incompatibility on 64-bit systems that breaks the output file.
	* src/imyp_sdl.c (imyp_sdl_fill_buffer, imyp_sdl_play_tune): moved
	  generating the samples out of the buffer-filling callback to the
	  main thread for efficiency.
	* src/{imyplay.h,Makefile.am,imyp_sdl.c,imywrap.c}: added support for
	  SDLv2. Since function and header names are the same for SDLv1 and
	  SDLv2, it's not possible to enable both backends at the same time.
	  Since the versions are similar enough, the same IMYplay backend
	  file supports both.
	* src/imyplay.c (main): fail fast, display help and return an error
	  if IMYplay is called by the name imyplay-exec, thus choosing the
	  EXEC backend, and no command to run is provided.
	* src/imyp_jck.c (imyp_jack_init): initialize all the members of the
	  user data structure before activating the backend.
	* src/imyp_jck.c (imyp_jack_fill_buffer): leave also if the buffer is
	  NULL, just in case the callback fires when not fully initialized.
	* src/imyp_por.c (imyp_portaudio_init): free() the backend's data on
	  one error path when initialization failed.
	* src/imyp_sdl.c (imyp_sdl_close): call also SDL_AudioQuit().
	* src/imyputil.c (imyp_generate_filename): always allocate the maximum
	  predicted room for the new filename, copy as much as it can hold.
	* src/imyp_cfg.hin, doc/imyplay.txc, imyplay.spi: added a comment
	  saying that 'configure' processes these files.
	* Makefile.am: added a fake helper target, 'x-gen-potfiles-in', to
	  show how to rebuild the po/POTFILES.in file. Renamed the 'pack'
	  target to 'x-pack'.
	* test/utiltest.c: added tests for the imyp_parse_system() and
	  imyp_get_format() functions.
	* Makefile.dos: a Makefile to build the DOS version of IMYplay under
	  DOSBox (which doesn't set %ERRORLEVEL%).
	* dosfiles.txt: changed to suite both dosdist.bat and Makefile.dos.
	* dosdist.bat: commented-out changing the working directory to be
	  compatible with Makefile.dos and made the necessary adjustments.
	* imyplay.spi: updated the description.
	* doc/imyplay.txc, README, INSTALL-imyplay.txt: removed the specific
	  versions of IMYplay that compile on various systems and replaced
	  the text with a generic note. Added the "SDL2" backend to the list
	  of backends that can be disabled. Added information that IMYplay
	  builds under DOSBox. Updates in how to build RPMs. Make the common
	  parts say the same.
	* README, doc/imyplay.txc, doc/imyplay.1: fix typos, make options'
	  descriptions more clear
	* doc/imyplay.txc: many improvements in the documentation: made URLs
	  into proper links, use the TeXinfo @file, @option, @kbd, @samp,
	  @command, @code and @verbatim properly, improved the description
	  on how to report errors, added a link to the home page on the
	  "What is IMYplay" page, added "Reporting issues".
	* doc/Makefile.am: added flags for generating the HTML documentation.
	* po/Makefile.in.in: renamed from po/Makefile.inn because of the
	  requirements of the new autoconf/gettext. It is thus no longer
	  possible to build IMYplay translations using autotools on systems
	  without long filename support (program compilation will still work).
	* po/POTFILES.in: updated finally after moving some of the messages
	  to src/iparsers.c.
	* ABOUT-NLS, config.rpath, po/Makefile.in.in, po/boldquot.sed,
	  po/en@boldquot.header, po/en@quot.header, po/insert-header.sin
	  po/Makevars.template, po/quot.sed, po/remove-potcdate.sin
	  po/Rules-quot, po/ChangeLog, m4/gettext.m4, m4/host-cpu-c-abi.m4,
	  m4/iconv.m4, m4/intlmacosx.m4, m4/lib-ld.m4, m4/lib-link.m4,
	  m4/lib-prefix.m4, m4/nls.m4, m4/po.m4, m4/progtest.m4, m4/ChangeLog,
	  configure.ac, po/Makevars: updated gettext to 0.21.

2021-09-23  gettextize  <bug-gnu-gettext@gnu.org>

	* m4/gettext.m4: Upgrade to gettext-0.21.
	* m4/host-cpu-c-abi.m4: New file, from gettext-0.21.
	* m4/iconv.m4: Upgrade to gettext-0.21.
	* m4/intlmacosx.m4: Upgrade to gettext-0.21.
	* m4/lib-ld.m4: Upgrade to gettext-0.21.
	* m4/lib-link.m4: Upgrade to gettext-0.21.
	* m4/lib-prefix.m4: Upgrade to gettext-0.21.
	* m4/nls.m4: Upgrade to gettext-0.21.
	* m4/po.m4: Upgrade to gettext-0.21.
	* m4/progtest.m4: Upgrade to gettext-0.21.
	* configure.ac (AM_GNU_GETTEXT_VERSION): Bump to 0.21.

2021-09-07	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 1.2.1
	  This is a compatibility-improvement and bugfix-only release. No new
	  features are added. Fixed compile errors on newer systems. Fixed
	  uninitialized memory usage in AO. Documentation updates. Other minor
	  fixes and updates.
	* configure.ac: added checking for the -Wstringop-truncation,
	  -Wduplicated-branches and -fstack-check compiler options. Prefer the
	  dir-prefixed includes over the non-dir-prefixed includes when
	  searching for sound system headers for the SDL, ALSA (especially),
	  AO, PortAudio, JACK and PulseAudio backends. Renamed GStreamer to
	  GStreamer-0.10 (version 1.x is incompatible).
	* src/imyp_als.c: prefer the alsa/*.h includes
	* src/imyp_ao.c: prefer the ao/*.h includes
	* src/imyp_jck.c: prefer the jack/*.h includes
	* src/imyp_por.c: prefer the portaudio/*.h includes even though they
	  don't exist right now
	* src/imyp_pul.c: prefer the pulse/*.h includes
	* src/imyp_sdl.c: prefer the SDL/*.h includes
	* src/imyplay.c: declare messages only when needed
	* src/imyputil.c (imyp_generate_filename): declare variables only when
	  malloc() is present. Correct strncpy() copying the whole string
	* src/imyp_exe.c (imyp_exec_init): correct strncpy() copying the whole
	  string
	* src/imyp_mid.c (imyp_midi_init): updated IMYplay's address
	* src/imyp_pul.c (imyp_pulse_play_tune): fix the sound by detecting
	  signedness correctly.
	* src/imyp_exe.c (launch_program): check the buffer length on each
	  iteration
	* src/imyp_ao.c (imyp_ao_init): fixed uninitialized variable (detected
	  by Valgrind)
	* src/imyp_gst.c (imyp_gst_init): deinitializing the library on error
	* src/imyp_gst.c (imyp_gst_close): deinitializing the library on close
	* src/*.c: added a preprocessor block that marks ANSI C as disabled,
	  for internal testing compiler compatibility.
	* src/midi*: fixed the FSF address as required by rpmlint.
	* test/Makefile.am: added a target to just compile the tests
	* doc/imyplay.txc, doc/imyplay.1, src/*.c, src/*.h*, AUTHORS,
	  ChangeLog, INSTALL-imyplay.txt, imyplay.spi, po/*.po, po/imyplay.pot,
	  test/utiltest.c: updated addresses
	* test/utiltest.c (test_imyp_generate_filename*): fix memleaks
	* imyplay.spi: removed obsolete commented-out commands, updated the
	  URL, added BugURL. Using macros for common elements. Fixed the
	  license as required by rpmlint. Added the %changelog tag as required
	  by rpmlint. Changed the build commands to match the new recommended
	  names.

2019-11-24	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 1.2
	  This is an important bugfix release. No new features are introduced.
	  Important fixes in SDL, PortAudio and JACK output system support.
	  Fixes in GStreamer and AO output system support. Compatibility and
	  portability improvements. Updated copyright and documentation. Other
	  small fixes.
	* configure.ac: Added checking for the -Wno-nonnull-compare compiler
	  flag to avoid warnings about defensive programming code. Added
	  checking for the -Wchkp, -Wformat-overflow=2, -Wrestrict
	  -Wduplicated-cond, -Woverlength-strings compiler warning options.
	  Added checking for the -g compiler option for the debuginfo RPM
	  package build to work by default. Stop enabling -Wpadded, most
	  warnings of this type are not useful in this case. Check for the
	  jack_get_version_string() function.
	* INSTALL-imyplay.txt: renamed from "INSTALL", overwritten by new
	  autotools 
	* Makefile.am: stop using 'tar --delete', for systems where GNU tar is
	  not installed or not the default
	* src/imyparse.c (imyp_show_token_error, imyp_play_file): a single
	  function for displaying "unexpected/unknown token" errors
	* src/imyputil.c (imyp_generate_filename): if the filename doesn't
	  contain ".imy", the requested extension is appended, but only if it
	  is not present yet. This prevents creating files like "name.raw.raw"
	* src/imyp_sig.c (print_signal_error): fix output buffer size
	* src/imyputil.c (imyp_generate_samples, imyp_generate_filename):
	  change variable types to avoid compiler warnings
	* src/imyputil.c (imyp_generate_samples): don't check if samp_rate is
	  negative - it can't be (warning generated by "cppcheck")
	* src/imyp_als.c (imyp_alsa_play_tune): change variable type and
	  return value to avoid compiler warnings
	* src/imyp_oss.c (imyp_oss_play_tune): change variable type and
	  return value to avoid compiler warnings
	* src/imyp_oss.c (imyp_oss_init): make variable name more proper
	* src/imyp_ao.c (imyp_ao_init): fixed reading the provided device ID,
	  make variable name more proper
	* src/imyp_gst.c (imyp_gst_init): if the "autoaudiosink" output
	  factory is unavailable, use "alsasink". This should make IMYplay
	  work on newer systems by default (not requiring to pass options)
	* src/imyp_jck.c (imyp_jack_backend_data, imyp_jack_fill_buffer):
	  change variable type to avoid compiler warnings
	* src/imyp_jck.c (imyp_jack_fill_buffer): check for remaining samples
	  to play at the beginning, for better thread synchronisation. Simply
	  re-write the pregenerated samples to the output buffer instead of
	  generating them here. This avoids buffer underruns and JACK errors
	* src/imyp_jck.c (imyp_jack_play_tune): check for valid input values,
	  check for signals during playback, set the number of samples in one
	  operation, for better thread synchronisation. Pregenerate all the
	  samples here instead of the callback, to reduce callback time. The
	  callback simply re-writes the samples to the JACK output buffer now
	* src/imyp_jck.c (imyp_jack_init): set the maximum possible buffer size
	* src/imyp_jck.c (imyp_jack_version): show the JACK version, if the
	  function jack_get_version_string() is available
	* src/imyp_spk.c (imyp_spkr_init): corrected the return values
	* src/imyp_sdl.c (imyp_sdl_init): changed the number of samples to 
	  match the sampling frequency, added enabling the timer subsystem,
	  locking the audio until the data is filled, small rearrangements
	* src/imyp_sdl.c (imyp_sdl_play_tune): added locking and unlocking the
	  audio subsystem while setting the input data. Waiting until all
	  samples are processed
	* src/imyp_sdl.c (imyp_sdl_fill_buffer): correctly calculate the
	  number of samples to put in the buffer, change variable types to
	  avoid compiler warnings
	* src/imyp_sdl.c (imyp_sdl_close): un-lock the playing thread to close
	  it properly
	* src/imyp_por.c (imyp_portaudio_play_tune): check for signals during
	  playback, change one error return value to be distinguishable.
	  Synchronise with the playing thread using the number of remaining
	  samples, like in SDL and JACK
	* src/imyp_por.c (imyp_portaudio_fill_buffer): simplify the loop which
	  is initially zeroing the buffer. Added a marker that the callback
	  should be called just one more time, to make time to play the note
	* src/imyp_por.c (imyp_portaudio_init): if parsing the user-provided
	  frequency fails, use 11025Hz, instead of 44100Hz, which can crash
	* src/imyp_pul.c (imyp_pulse_init): make variable name more proper
	* src/imyparsf.l (imyp_play_file): display an error if the input file
	  can't be opened, correctly check for the current backend
	* README, doc/imyplay.txc, doc/imyplay.1: Added a note how to start
	  the JACK server manually, if needed. Updated links and compatible
	  systems, typo fixes
	* test/utiltest.c: added tests for the filename generation algorithm
	* po/LINGUAS, imyplay.spi: added the en@quot and en@boldquot
	  pseudo-translations.
	* imyplay.spi: made the spec file more portable (assuming that the
	  required macros are properly defined on the target systems) and
	  removed some rpmlint warnings and errors

2018-07-08	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 1.1
	  PortAudio output improvements. Small improvements in SDL & JACK
	  output. Fixed creating output file names. Small improvements in
	  the building mechanism. Added unit tests.
	* configure.ac: setting AC_LANG(C). Checking for the "check" library
	  for unit tests. Added AM_PROG_CC_C_O for compatibility.
	* src/imyparse.c: Removed some invalid comments
	* src/Makefile.am: changed deprecated INCLUDES to AM_CPPFLAGS
	* src/imyp_por.c (imyp_portaudio_play_tune): move output initialization
	  to imyp_portaudio_init and closing to imyp_portaudio_close. Now
	  initializing the stream just once and only calling start and stop
	  for each tone. Synchronous mode is easier to program, but either
	  crashes or reports underrun errors in the output device, so for now,
	  asynchronous mode will stay. Setting up the maximum number of frames
	  needed for the tone.
	* src/imyp_por.c (imyp_portaudio_fill_buffer): now filling just as
	  many frames as is needed for the tone (setting up the maximum number
	  of frames needed and decreasing it each time a buffer is filled).
	  This allows a bit finer control over the duration of the tone being
	  played. The output buffer is zeroed-out on each call before filling
	  it with data.
	* src/imyp_por.c (imyp_portaudio_init): initializing not only the
	  output backend, but also the playing stream.
	* src/imyp_por.c (imyp_portaudio_close): closing not only the output
	  backend, but also the playing stream.
	* src/imyp_sdl.c (imyp_sdl_fill_buffer): now filling just as
	  many frames as is needed for the tone (setting up the maximum number
	  of frames needed and decreasing it each time a buffer is filled).
	  This allows a bit finer control over the duration of the tone being
	  played. The output buffer is zeroed-out on each call before filling
	  it with data.
	* src/imyp_sdl.c (imyp_sdl_play_tune): setting up the maximum number
	  of frames needed for the tone.
	* src/imyp_jck.c (imyp_jack_fill_buffer): now filling just as
	  many frames as is needed for the tone (setting up the maximum number
	  of frames needed and decreasing it each time a buffer is filled).
	  This allows a bit finer control over the duration of the tone being
	  played. The output buffer is zeroed-out on each call before filling
	  it with data.
	* src/imyp_jck.c (imyp_jack_play_tune): setting up the maximum number
	  of frames needed for the tone.
	* src/imyparse.c (imyp_play_file): checking the volume values for
	  overflow.
	* src/imyparse.c (imyp_read_line): use a constant instead of
	  strlen (IMYP_MEL_END).
	* test: added unit tests for IMYplay, currently only for the
	  imyp_compare() and imyp_generate_filename() of src/imyputil.c
	* src/imyputil.c (imyp_generate_filename): if the filename doesn't
	  contain ".imy", the requested extension is appended. This prevents
	  overwriting input files.
	* doc/Makefile.am: noted why it's impossible to correctly remove the
	  generated imyplay.txi from the distribution. corrected man pages'
	  distribution settings.
	* src/imyp_sig.h, *.c, imyparsf.l: rename sig_recvd to imyp_sig_recvd
	* imyplay.spi: small improvements

2016-07-29	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 1.0
	  Improved sound output quality. Improved special (MIDI, FILE, EXEC)
	  output file generation and command-line parsing. Constant
	  calculations performed just once to improve sample generation time.
	  Other minor fixes and improvements.
	* src/imyputil.c (imyp_generate_samples): calculating constant values
	  just once per call or per loop iteration, where possible. Improved
	  samples' quality and code consistency in bytes vs. samples. Improved
	  partial buffer filling.
	* src/imyp_por.c (imyp_portaudio_play_tune): check for data == NULL
	* src/imyp_ao.c (imyp_ao_play_tune): change sample format to signed -
	  this fixes the strange sound problem
	* src/imyputil.c (imyp_generate_filename): a new function for creating
	  output filenames for the FILE and MIDI backends. This function
	  removes any ".imy" extension and appends the provided one instead.
	  If the filename doesn't contain ".imy", it is not changed.
	* src/imyp_fil.c (imyp_file_init): using the new filename generating
	  function. Fixed possible overwriting the input file.
	* src/imyp_mid.c (imyp_midi_init): using the new filename generating
	  function.
	* src/imyplay.c (main): don't pass MIDI-specific parameters during
	  initialization of the FILE and EXEC backends. Don't pass
	  FILE-specific parameters during initialization of the MIDI and EXEC
	  backends. Don't pass EXEC-specific parameters during initialization
	  of the MIDI and FILE backends. Prevent the other two special
	  (non-sound) backends from being initialized when any one of the
	  MIDI, EXEC or FILE backend is chosen. This fixes multiple files from
	  being created when they would be unused anyway. When getopt_long()
	  is not present and manual command-line parsing is used, also quit
	  when a required command-line argument is missing. Errors during
	  initialization of special outputs are now reflected in the exit
	  code as well.
	* src/imyp_jck.c (imyp_jack_fill_buffer): calculating constant values
	  just once per call, where possible.
	* src/imyp_exe.c (launch_program, imyp_put_value_as_*): separate functions
	  for putting values in the buffer. Making sure that the buffer won't
	  overflow. Conditionally compiling the code that checks the exit code
	  of the called program.
	* src/imyp_sig.c (imyp_set_sigh): simplified error display and return
	* src/imyp_all.c (imyp_all_init): setting the volume to the maximum
	* README, doc/imyplay.txc: added a note about which output options
	  override which
	* src/imyp_all.c (imyp_all_audiostream_init, imyp_all_play_tune): now
	  initializing the sound output stream to just exactly the required
	  buffer size
	* src/imyp_all.c (imyp_all_play_tune): filling the Allegro buffer to
	  just the size filled by imyp_generate_samples(). Filling as many
	  Allegro buffers as we get (filling in a loop now, instead of just
	  one time).
	* src/iparsers.c: removed duplicate definitions of IMYP_C and IMYP_A*.
	* src/imyplay.h: added missing declaration for "err_msg".
	* src/imyparsf.l: added casts for printing values
	* src/imyp_gst.c (imyp_gst_init): use variables instead of string
	  constants to match function prototypes

2014-11-23	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 0.9
	  Code cleanup, documentation updates. Corrected command-line parsing.
	  Corrected some backends' startup and shutdown. Corrected parsing
	  binary files. Fixed some memory leaks.
	* README, doc/imyplay.txc, INSTALL: added info that under DOS LFN
	  support can be enabled instead of renaming files required for
	  compiling.
	* doc/imyplay.txc, imyplay.spi: updated WWW addresses
	* src/*.{c,h}: renamed the PARAMS macro to IMYP_PARAMS
	* src/imyp_por.c (imyp_portaudio_play_tune), src/imyp_sdl.c
	  (imyp_sdl_play_tune), src/imyp_jck.c (imyp_jack_play_tune): removed
	  empty statements
	* src/imyparse.c (imyp_play_file): fixed variable casting, fixed
	  playing more than one file (resetting the parser state before each
	  file played)
	* src/imyp_por.c, src/imyp_sdl.c: removed unnecessary include of
	  math.h and unnecessary define of M_PI
	* src/imyp_exe.c: fixed #defines at the top
	* src/*.c: made the *_static structures really static (scope reduced)
	* src/imyplay.h: #undefining IMYP_ANSIC before redefinition, added
	  IMYP_HAVE_SELECT.
	* src/imyp_por.c, src/imyp_sdl.c, src/imyp_all.c, src/imyputil.c:
	  switched to using IMYP_HAVE_SELECT.
	* src/imyp_exe.c (launch_program): loop limit calculated just once.
	* src/imyputil.c (imyp_generate_samples): arguments to IMYP_MIN
	  evaluated just once.
	* src/imyparse.c, src/imyputil.c, src/imyparsf.l: moved IMYP_TOUPPER
	  and IMYP_IS_DIGIT to imyplay.h.
	* src/imyp_por.c, src/imyp_sdl.c: prefer to use the library-specific
	  pause function instead of select().
	* src/*.c: braces around conditionals
	* src/imypwrap.c (imyp_lib_init, imyp_pause, imyp_init_selected):
	  corrected non-ANSI declarations, cleaned up conditionals in
	  declarations
	* src/imypdos.asm: a common macro for leaving the function, comment
	  fixed
	* src/imyparse.c, src/iparsers.c, src/imyparsf.l: moved imyp_notes,
	  note-related defines and other common parsing-related declarations
	  to iparsers.c.
	* src/imyp_fil.c (imyp_file_close): corrected closing the file
	* src/imyp_mid.c (imyp_midi_init): moved filename null check higher,
	  fixed the IMYplay WWW address
	* src/imyp_fil.c (imyp_file_init), src/imyplay.c (main): allow the
	  raw file output to work with multiple input files
	* src/imyp_fil.c: added checking if the backend was enabled
	* src/imyplay.c (main): allow the MIDI output to work with multiple
	  input files
	* src/imyparsf.l: enabled skipping also binary data (control
	  characters and non-ASCII bytes) outside iMelody blocks. This way the
	  program will not hang when reading binary files.
	* src/imyp_oss.c (imyp_oss_init): now trying all possible combinations
	  of the format and sampling frequency before giving up
	* dosfiles.txt: added iparsers.c
	* src/imyp_all.c (imyp_all_init): fixed memory leak on error path
	* configure.ac: unconditional checking for select() and related
	  headers, checking for "flex" unconditionally (because it is required
	  by "make dist"), changed the FLEX conditional
	* src/imyparsf.l (imyp_play_file): fixed playing more than one file
	  (resetting the parser state before each file played)
	* src/imyparse.c (imyp_read_line, imyp_play_file): fixed variable
	  casting when fseeko and ftello are not present
	* Makefile.am: removed doc/imelody.txt from EXTRA_DIST (it is already
	  included in doc/Makefile.am), manually removing src/imyparsf.c
	  from the distribution (it is generated by the flex parser)

2013-04-02	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 0.8
	  Made the backends thread-safe (using allocated control structures
	  instead of static). Corrected PortAudio and SDL outputs.
	* configure.ac: checking for the -O3 compiler option
	* doc/imyplay.txc: added @dircategory and @direntry
	* src/imyplay.h: corrected DOS dependency of the PC-speaker backend
	* src/imyp_spk.c (imyp_spkr_close): disabling sound on close in DOS
	* src/imyp_mid.c (imyp_midi_init): updated the website address
	* src/imyputil.{c,h} (imyp_pause_select, imyp_put_text_stdout):
	  common general pause & text printing functions.
	* src/imyp_sdl.c: shortened the pauses between sound by opening the
	  audio just once, not for each note. Allow controlling the sample
	  rate and format.
	* src/imyp_ao.c (imyp_ao_init): shutting down in case of error
	* src/imyp_als.c (imyp_alsa_init): freeing resources in case of error
	* src/imyp_por.c: corrected sound generating by using a lower sampling
	  frequency, smaller buffer and managing the buffer properly. Allow
	  controlling the sample rate and format.
	* src/imyputil.{c,h} (imyp_generate_samples): made the general sample
	  generating function support a starting offset (for SDL and PortAudio)
	* src/imyp_por.c (imyp_portaudio_fill_buffer): converted to use the
	  general sampling generating function
	* src/imyp_sdl.c (imyp_sdl_fill_buffer): converted to use the
	  general sampling generating function
	* src/imyp_all.c: allow controlling the sample rate and format.
	* dosdist.bat: using sed to translate line endings, using a variable
	  for the version number, manually setting the timezone for ZIP (and
	  restoring the previous after compressing), using more optimization,
	  not including technical files in the "doc" subdirectory
	* README, doc/imyplay.txc, INSTALL, doc/imyplay.1: documentation update

2012-07-14	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 0.7
	  PC-speaker output support. Portability improvements. Code cleanup
	  (removed unnecessary includes and made other corrections for
	  various backends).
	* src/imyparsf.l: correctly freeing all memory after processing.
	* configure.ac: corrected the JACK, Pulseaudio, Portaudio, Libao,
	  OSS, ALSA, SDL and Allegro backends in the summary and in the
	  automake conditionals. The malloc() and realloc() functions are
	  now required for the flex-based parser. Corrected the
	  --enable-GSTREAMER option. Corrected checking for requirements of
	  the flex-based parser.
	* src/imyp_spk.{c,h}, configure.ac, src/imypwrap.c, src/imyputil.c,
	  src/imyplay.h, src/Makefile.am, src/imypdos.asm: PC-speaker support.
	* README, doc/imyplay.txc, INSTALL, doc/imyplay.1: documentation update
	* dosfiles.txt: added the PC-speaker to be available under DOS.
	* src/imyp_cfg.hin: added a constant when compiling under DOS. Making
	  sys/select.h unavailable unedr DOS (as it should be).
	* src/imyp_fil.c (imyp_file_init): corrected compiling for non-ANSI-C
	  compilers.
	* dosdist.bat: checking the error code after important commands, added
	  optimization when compiling, converting line endings and file names
	  of the documents.
	* src/imypwrap.c (imyp_init_selected): corrected compiling for
	  non-ANSI-C compilers. Marked some parameters as unused when the
	  corresponding backends are not compiled.
	* src/imyplay.c (main): corrected compiling when the MIDI or FILE
	  backends are disabled.
	* src/Makefile.am: corrected the FILE backend condition
	* src/imypwrap.c (imyp_lib_init): marked some parameters as unused
	  when the corresponding backends are not compiled.
	* imyplay.spi: added the supported backends to the description

2011-10-06	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 0.6
	  A new, flex-generated parser for the melody files. Displaying
	  backend libraries' versions along with  imyplay's version. Raw
	  file output backend. Support for LibNetBlock and LibHideIP.
	* configure.ac: checking for flex for the new parser, added new
	  C compiler flags to check: -Wwrite-strings and -Waggregate-return.
	  Added raw file output option. Support for LibNetBlock and LibHideIP.
	* src/Makefile.am: added the flex-based scanner. Added raw file output
	  source codes to program sources.
	* src/imyplay.c: fix missing "const". Added missing '?' option.
	* src/imyparsf.l: the new flex-based scanner source.
	* src/imyputil.{c,h}: new file with utility functions: output system
	  name parsing (moved from imypwrap.c), case-insensitive string
	  compare (moved from imypwrap.c), common samples' generation (moved
	  from the Allegro, ALSA, AO, OSS and PulseAudio backends).
	* src/imyplay.c, src/wrappers.{c,h}: Added displaying the libraries'
	  versions along with the program's vesrion.
	* src/imyp_fil.{c,h}: raw file backend
	* src/{imyplay.h,imyplay.c,wrappers.c}: added an "IMYP_" prefix to
	  current library enumeration.
	* src/imyplay.c: Support for LibNetBlock and LibHideIP.
	* src/imyp_jck.c, src/imyp_por.c, src/imyp_sdl.c: fixed samples'
	  generation in case of small sampling frequencies or high tones.
	* dosdist.bat: moved file list to a separate file, dosfiles.txt, to
	  avoid DOS command line length limit of 128 characters.

2011-03-26	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 0.5
	  MIDI instrument number now selectable. Fixed some functions'
	  descriptions. Output sound system now selectable by command-line
	  and the program's name. GStreamer output. Run flawfinder, rats
	  and cppcheck on the code and fixed a few performance problems.
	* configure.ac: fixed double CFLAGS on compile.
	* README: added the glibc license block. Updated RPM creating.
	  Updated command-line options.
	* imyplay.spi: added README, COPYING, AUTHORS and ChangeLog
	  to the RPM package.
	* doc/imyplay.txc: updated RPM creating. Updated command-line options.
	* doc/imyplay.1: Updated command-line options.
	* src/imyparse.{c,h}: separate files for parsing melody files with
	  simplified code.
	* src/imyparse.c (imyp_play_file): Errors displayed in more cases of
	  unknown tokens in the IMY file.
	* src/imyplay.c, src/imywrap.{c,h}, src/imyp_mid.{c,h}: MIDI
	  instrument number now selectable.
	* src/imyplay.c, src/imywrap.{c,h}: Output sound system now
	  selectable by command-line and the program's name.
	* src/imywrap.c, src/imyp_gst.{c,h}: GStreamer output.
	* README, doc/imyplay.txc, doc/imyplay.1, INSTALL: GStreamer support
	  information.

2010-06-27	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 0.4
	  Upgrade to newer autotools and gcc. Run flawfinder on the code and
	  changed some parts according to the result. Upgrade to gettext-0.17.
	  Corrected compiling for non-ANSI-C compilers.
	* imyplay.spi: fixed warnings displayed by rpmlint.
	* src/imyplay.h: renamed SAMPBUFSIZE, MIN, MAX, CURR_LIB, OCTAVES,
	  NOTES_PER_OCTAVE, error_type, show_error, sig_unk, err_msg_signal,
	  and notes to have the IMYP_/imyp_ prefix. Defined IMYP_ANSIC for
	  function prototypes.
	* configure.ac, configure: new command-line option --enable-MIDI to
	  enable/disable MIDI output (which is almost unaltered and thus
	  could cause problems with some compilers). New command-line option
	  --enable-EXEC to enable/disable the backend that executes the given
	  program instead of sound output.
	* src/Makefile.am, src/imypwrap.c: MIDI support now conditional.
	* src/imyp_jck.c: replaced free() with jack_free() and thus removed
	  including the stdlib and malloc header files. Verified compiling
	  against JACK2 header files. Verified working with JACK2 daemon.
	* src/imyp_jck.c, src/imyp_sdl.c, src/imyp_por.c: zero-out static
	  data structures on init. Decreasing the buffer index only when the
	  tone frequency was greater than zero, setting it to zero otherwise.
	  Synchronizing the callback functions to avoid zeroing the tone
	  frequency inside the loops.
	* src/imyp_mid.c: fixed the duration of notes and pauses.
	* src/imyp_exe.c: a new backend that executes a given program instead
	  of sound output.
	* src/imypwrap.c, src/imyplay.c, src/imyp_sig.c: EXEC backend support.
	* src/imyp_sdl.c: fixed signed/unsigned samples.
	* src/imyp_por.c (imyp_portaudio_play_tune): corrected closing the
	  audio stream.
	* src/imyp_all.c (imyp_all_pause): use select() if available.
	* src/imyp_als.c (imyp_alsa_play_tune): corrected filling the buffer.
	* src/imyp_ao.c (imyp_ao_play_tune): corrected filling the buffer.
	* src/imyp_oss.c (imyp_oss_play_tune): corrected filling the buffer.
	  Fixed signed/unsigned samples.
	* src/imyp_pul.c (imyp_pulse_play_tune): corrected filling the buffer.
	* src/imyp_sdl.c (imyp_sdl_play_tune): corrected initializing.
	* src/imyp_all.c (imyp_all_play_tune): corrected filling the buffer.
	* src/imyp_als.c (imyp_alsa_close): releasing the parameters' buffer.
	* src/imyp_mid.c (imyp_midi_init): making sure filename buffers are
	  zero-terminated.
	* src/imyp_als.c (imyp_alsa_init): fixed initializing the device.
	* src/imyplay.c: MIDI & EXEC backend command-line options now compiled
	  conditionally. Corrected parsing command-line options without getopt.

2009-06-27	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 0.3
	  SDL, ALSA, OSS, LIBAO, PortAudiov19, PulseAudio and JACK1 support.
	  Fixed endianess problem of 16-bit samples. Checking if the standard
	  output isn't NULL before printing text in the backends.
	* configure.ac: fixed: getopt.h no longer required, reacting on
	  parameters, check for off_t and size_t. Added "--enable-allegro",
	  "--enable-SDL", "--enable-ALSA", "--enable-LIBAO",
	  "--enable-PORTAUDIO", "--enable-PULSEAUDIO" and "--enable-JACK"
	  options.
	* configure.ac, src/Makefile.am: the program now really compiles
	  without the Allegro library.
	* imyplay.h: defining library constants, added IMYP_MAX_IMY_VOLUME,
	  added MIN() and MAX() macros.
	* imyp_sdl.{c,h}, imypwrap.c: SDL support.
	* imyplay.c, imyp_all.c, imyp_sdl.c: using IMYP_MAX_IMY_VOLUME.
	* imyp_als.{c,h}, imypwrap.c: ALSA support.
	* imyp_ao.{c,h}, imypwrap.c: LIBAO support.
	* imyp_por.{c,h}, imypwrap.c: PortAudiov19 support.
	* imyp_pul.{c,h}, imypwrap.c: PulseAudio support.
	* imyp_jck.{c,h}, imypwrap.c: JACK1 support.
	* imyplay.c (imyp_read_line): fixed getting the current file position.

2009-02-21	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 0.2
	  Added converting IMY files to MIDI format 1, with the command-line
	  option '--to-midi' (affects all the files on the command line).
	  Added thanks. Moved text displaying to library-dependent code.
	* configure.ac: The Allegro library is required only for playing.
	  IMYplay will compile without it. Added a check for the 'volatile'
	  type. Removed some unused tests. The string.h header is required,
	  getopt.h is not.
	* src/imyp_cfg.hin: portability corrections.
	* src/imyp_sig.c: using only defined signals. Fixed displaying.

2009-01-20	Bogdan Drozdowski <bogdro =at/ users . sourceforge . net>

	* IMYplay version 0.1
	  Complies to the iMelody specification (doc/imelody.txt), uses the
	  Allegro library, captures signals. Modular structure allows easy
	  adding new sound libraries in the future. Full documentation
	  included.
